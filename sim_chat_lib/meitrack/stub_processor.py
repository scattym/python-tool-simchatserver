#!/usr/bin/env python
import logging
from sim_chat_lib.meitrack.gprs_protocol import GPRS


logger = logging.getLogger(__name__)
SPURIOUS_REPORT = """$$D160,864507032228727,AAA,35,24.819116,121.026091,180323023615,A,7,16,0,176,1.3,83,7,1174,466|97|527B|01035DB4,0000,0001|0000|0000|019A|0981,00000001,,3,,,36,23*DC\r\n""",
REQUEST_TO_RESPONSE = {
    """A11,""": """$$S28,353358017784062,A11,OK*FE\r\n""",
    """A10,""": """$$Q164,864507032228727,AAA,35,24.818910,121.025936,180329052345,A,7,13,0,16,1.2,69,2720,86125,466|97|527B|01035DB4,0000,0001|0000|0000|019E|097F,00000001,,3,,,124,96*F2\r\n""",
    """A12,""": """$$V28,353358017784062,A12,OK*02\r\n""",
    """A13,""": """$$X28,353358017784062,A13,OK*05\r\n""",
    """A14,""": """$$D28,353358017784062,A14,OK*F2\r\n""",
    """A15,6""": """$$E28,353358017784062,A15,OK*F4\r\n""",
    """A16,0""": """$$F28,353358017784062,A16,OK*F6\r\n""",
    """A17,1""": """$$T28,353358017784062,A17,OK*05\r\n""",
    """A19,1""": """$$H28,353358017784062,A19,OK*F8\r\n""",
    """A21,1,67.203.13.26,8800,,,""": """$$H28,353358017784062,A21,OK*F4\r\n""",
    """A22,75.127.67.90""": """$$K28,353358017784062,A22,OK*F8\r\n""",
    """A23,67.203.13.26,8800""": """$$S28,353358017784062,A23,OK*01\r\n""",
    """A70""": """$$T85,353358017784062,A70,13811111111,13822222222,13833333333,13844444444,13855555555*21\r\n""",
    """A71,13811111111,13822222222,13833333333""": """$$U28,353358017784062,A71,OK*06\r\n""",
    """A72,13844444444,13855555555""": """$$V28,353358017784062,A72,OK*08\r\n""",
    """A73,2""": """$$W28,353358017784062,A73,OK*0A\r\n""",
    """AFF,1""": """$$h28,353358017784062,AFF,OK*3D\r\n""",
    """B05,1,22.913191,114.079882,1000,0,1""": """$$H28,353358017784062,B05,OK*F7\r\n""",
    """B06,1""": """$$J28,353358017784062,B06,OK*FA\r\n""",
    """B07,60""": """$$P28,353358017784062,B07,OK*01\r\n""",
    """B08,3""": """$$I28,353358017784062,B08,OK*FB\r\n""",
    """B21,1""": """$$C28,353358017784062,B21,OK*F0\r\n""",
    """B31,10""": """$$J28,353358017784062,B31,OK*F8\r\n""",
    """B34,60""": """$$N28,353358017784062,B34,OK*FF\r\n""",
    """B35,480""": """$$O28,353358017784062,B35,OK*01\r\n""",
    """B36,480""": """$$P28,353358017784062,B36,OK*03\r\n""",
    """B60,1""": """$$U28,353358017784062,B60,OK*05\r\n""",
    """B91,1,SOS""": """$$R28,353358017784062,B91,OK*06\r\n""",
    """B92,1234567890ABCDEF""": """$$q28,353358017784062,B92,OK*26\r\n""",
    """B93""": """$$V42,353358017784062,B93,00000007E01C001F*B5\r\n""",
    """B96,0000000000000001""": """$$A28,353358017784062,B96,OK*FA\r\n""",
    """B97""": """$$C42,353358017784062,B97,0000000000000001*60\r\n""",
    """B99,gprs,get""": """$$B33,863070010825791,B99,1,17,18*B5\r\n""",
    """C01,20,10122""": """$$M28,353358017784062,C01,OK*F9\r\n""",
    """C02,0,15360853789,Meitrac""": """$$f28,353358017784062,C02,OK*13\r\n""",
    """C03,0""": """$$f28,353358017784062,C03,OK*14\r\n""",
    """C13,0,E,TestMessage""": """$$m28,013777001338688,C13,OK*1C\r\n""",
    """C41,01""": """$$n30,012896001078259,C41,01,1*37\r\n""",
    """C47,2,90,10""": """$$f28,353358017784062,C47,OK*1C\r\n""",
    """C48""": """$$c33,353358017784062,C48,2,90,10*D0\r\n""",
    """C49,3,2""": """$$c28,353358017784062,C49,ok*5B\r\n""",
    """D01,0""": """$$A480,353358017784062,D01,3,0,0506162517_C1E03.jpg|0506162517_C1E11.jpg|0506162624_C1E03.jpg|0506162630_C1E11.jpg|0506162720_C1E03.jpg|0506162721_C1E03.jpg|0215080547_C1E03.jpg|0215080547_C1E11.jpg|0215080626_C1E03.jpg|0215080626_C1E11.jpg|0215080827_C1E03.jpg|0215080827_C1E11.jpg|0215080850_C1E03.jpg|0215080850_C1E11.jpg|0507145426_C1E03.jpg|0507145426_C1E11.jpg|0507145512_C2E03.jpg|0507145512_C2E11.jpg|0215080050_C3E03.jpg|0215080050_C3E11.jpg|0215080459_C3E03.jpg|021508050*41\r\n""",
    """D02,0506162517_C1E03.jpg|0506162517_C1E11.jpg|0506162624_C1E03.jpg|0506162630_C1E11.jpg|""": """$$F28,353358017784062,D02,OK*F4\r\n""",
    """D03,1,camerapicture.jpg""": """$$D28,353358017784062,D03,OK*F3\r\n""",
    """D10,13737431,13737461""": """$$f28,353358017784062,D10,OK*13\r\n""",
    """D11,13737431,1""": """$$e28,353358017784062,D11,OK*13\r\n""",
    """D12,13737431""": """$$C27,353358017784062,D12,0*87\r\n""",
    """D14,13723455""": """$$Q28,353358017784062,D14,OK*02\r\n""",
    """D15,13723455,3""": """$$K28,353358017784062,D15,OK*FD\r\n""",
    """D16""": """$$u28,353358017784062,D16,18*F7\r\n""",
    """D65,30000,50000,60000,70000,80000,90000,100000,110000""": """$$V28,353358017784062,D65,OK*OD\r\n""",
    """D66,8726,8816,8906,8996,9086,9176,9266,9356""": """$$V28,353358017784062,D66OK*E2\r\n""",
    """E91""": """$$W38,353358017784062,FWV1.00,12345678*1C\r\n""",
    """F01""": """$$j28,353358017784062,F01,OK*19\r\n""",
    """F02""": """$$Z28,353358017784062,F02,OK*0A\r\n""",
    """F08,0,4825000""": """$$D28,353358017784062,F08,OK*FA\r\n""",
    """F09,1""": """$$E28,353358017784062,F09,OK*FC\r\n""",
    """F11""": """$$[28,353358017784062,F11,OK*0B\r\n""",
}


class NotMyIMEIError(Exception):
    pass


def request_to_response(request_command, imei):
    for key in REQUEST_TO_RESPONSE:
        command_length = len(key)
        if request_command[0:command_length] == key:
            return_gprs = GPRS(REQUEST_TO_RESPONSE[key])
            return_gprs.imei = imei
            return repr(return_gprs)
    return None


if __name__ == '__main__':
    log_level = 11 - 11

    logger = logging.getLogger('')
    logger.setLevel(logging.DEBUG)
    ch = logging.StreamHandler()
    ch.setLevel(logging.DEBUG)
    formatter = logging.Formatter(
        '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    )
    ch.setFormatter(formatter)
    logger.addHandler(ch)

    for command in REQUEST_TO_RESPONSE:
        test_gprs = request_to_response(command, "IMEI")
        print(repr(test_gprs))