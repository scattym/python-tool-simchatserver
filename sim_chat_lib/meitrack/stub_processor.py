#!/usr/bin/env python
import logging
from sim_chat_lib.meitrack.gprs_protocol import GPRS


logger = logging.getLogger(__name__)
SPURIOUS_REPORT = b"""$$D160,864507032228727,AAA,35,24.819116,121.026091,180323023615,A,7,16,0,176,1.3,83,7,1174,466|97|527B|01035DB4,0000,0001|0000|0000|019A|0981,00000001,,3,,,36,23*DC\r\n""",
REQUEST_TO_RESPONSE = {
    b"""A11,""": b"""$$S28,353358017784062,A11,OK*FE\r\n""",
    b"""A10,""": b"""$$Q164,864507032228727,AAA,35,24.818910,121.025936,180329052345,A,7,13,0,16,1.2,69,2720,86125,466|97|527B|01035DB4,0000,0001|0000|0000|019E|097F,00000001,,3,,,124,96*F2\r\n""",
    b"""A12,""": b"""$$V28,353358017784062,A12,OK*02\r\n""",
    b"""A13,""": b"""$$X28,353358017784062,A13,OK*05\r\n""",
    b"""A14,""": b"""$$D28,353358017784062,A14,OK*F2\r\n""",
    b"""A15,6""": b"""$$E28,353358017784062,A15,OK*F4\r\n""",
    b"""A16,0""": b"""$$F28,353358017784062,A16,OK*F6\r\n""",
    b"""A17,1""": b"""$$T28,353358017784062,A17,OK*05\r\n""",
    b"""A19,1""": b"""$$H28,353358017784062,A19,OK*F8\r\n""",
    b"""A21,1,67.203.13.26,8800,,,""": b"""$$H28,353358017784062,A21,OK*F4\r\n""",
    b"""A22,75.127.67.90""": b"""$$K28,353358017784062,A22,OK*F8\r\n""",
    b"""A23,67.203.13.26,8800""": b"""$$S28,353358017784062,A23,OK*01\r\n""",
    b"""A70""": b"""$$T85,353358017784062,A70,13811111111,13822222222,13833333333,13844444444,13855555555*21\r\n""",
    b"""A71,13811111111,13822222222,13833333333""": b"""$$U28,353358017784062,A71,OK*06\r\n""",
    b"""A72,13844444444,13855555555""": b"""$$V28,353358017784062,A72,OK*08\r\n""",
    b"""A73,2""": b"""$$W28,353358017784062,A73,OK*0A\r\n""",
    b"""AFF,1""": b"""$$h28,353358017784062,AFF,OK*3D\r\n""",
    b"""B05,1,22.913191,114.079882,1000,0,1""": b"""$$H28,353358017784062,B05,OK*F7\r\n""",
    b"""B06,1""": b"""$$J28,353358017784062,B06,OK*FA\r\n""",
    b"""B07,60""": b"""$$P28,353358017784062,B07,OK*01\r\n""",
    b"""B08,3""": b"""$$I28,353358017784062,B08,OK*FB\r\n""",
    b"""B21,1""": b"""$$C28,353358017784062,B21,OK*F0\r\n""",
    b"""B31,10""": b"""$$J28,353358017784062,B31,OK*F8\r\n""",
    b"""B34,60""": b"""$$N28,353358017784062,B34,OK*FF\r\n""",
    b"""B35,480""": b"""$$O28,353358017784062,B35,OK*01\r\n""",
    b"""B36,480""": b"""$$P28,353358017784062,B36,OK*03\r\n""",
    b"""B60,1""": b"""$$U28,353358017784062,B60,OK*05\r\n""",
    b"""B91,1,SOS""": b"""$$R28,353358017784062,B91,OK*06\r\n""",
    b"""B92,1234567890ABCDEF""": b"""$$q28,353358017784062,B92,OK*26\r\n""",
    b"""B93""": b"""$$V42,353358017784062,B93,00000007E01C001F*B5\r\n""",
    b"""B96,0000000000000001""": b"""$$A28,353358017784062,B96,OK*FA\r\n""",
    b"""B97""": b"""$$C42,353358017784062,B97,0000000000000001*60\r\n""",
    b"""B99,gprs,get""": b"""$$B33,863070010825791,B99,1,17,18*B5\r\n""",
    b"""C01,20,10122""": b"""$$M28,353358017784062,C01,OK*F9\r\n""",
    b"""C02,0,15360853789,Meitrac""": b"""$$f28,353358017784062,C02,OK*13\r\n""",
    b"""C03,0""": b"""$$f28,353358017784062,C03,OK*14\r\n""",
    b"""C13,0,E,TestMessage""": b"""$$m28,013777001338688,C13,OK*1C\r\n""",
    b"""C41,01""": b"""$$n30,012896001078259,C41,01,1*37\r\n""",
    b"""C47,2,90,10""": b"""$$f28,353358017784062,C47,OK*1C\r\n""",
    b"""C48""": b"""$$c33,353358017784062,C48,2,90,10*D0\r\n""",
    b"""C49,3,2""": b"""$$c28,353358017784062,C49,ok*5B\r\n""",
    b"""D01,0""": b"""$$A480,353358017784062,D01,3,0,0506162517_C1E03.jpg|0506162517_C1E11.jpg|0506162624_C1E03.jpg|0506162630_C1E11.jpg|0506162720_C1E03.jpg|0506162721_C1E03.jpg|0215080547_C1E03.jpg|0215080547_C1E11.jpg|0215080626_C1E03.jpg|0215080626_C1E11.jpg|0215080827_C1E03.jpg|0215080827_C1E11.jpg|0215080850_C1E03.jpg|0215080850_C1E11.jpg|0507145426_C1E03.jpg|0507145426_C1E11.jpg|0507145512_C2E03.jpg|0507145512_C2E11.jpg|0215080050_C3E03.jpg|0215080050_C3E11.jpg|0215080459_C3E03.jpg|021508050*41\r\n""",
    b"""D02,0506162517_C1E03.jpg|0506162517_C1E11.jpg|0506162624_C1E03.jpg|0506162630_C1E11.jpg|""": b"""$$F28,353358017784062,D02,OK*F4\r\n""",
    b"""D03,1,camerapicture.jpg""": b"""$$D28,353358017784062,D03,OK*F3\r\n""",
    b"""D10,13737431,13737461""": b"""$$f28,353358017784062,D10,OK*13\r\n""",
    b"""D11,13737431,1""": b"""$$e28,353358017784062,D11,OK*13\r\n""",
    b"""D12,13737431""": b"""$$C27,353358017784062,D12,0*87\r\n""",
    b"""D14,13723455""": b"""$$Q28,353358017784062,D14,OK*02\r\n""",
    b"""D15,13723455,3""": b"""$$K28,353358017784062,D15,OK*FD\r\n""",
    b"""D16""": b"""$$u28,353358017784062,D16,18*F7\r\n""",
    b"""D65,30000,50000,60000,70000,80000,90000,100000,110000""": b"""$$V28,353358017784062,D65,OK*OD\r\n""",
    b"""D66,8726,8816,8906,8996,9086,9176,9266,9356""": b"""$$V28,353358017784062,D66OK*E2\r\n""",
    b"""E91""": b"""$$X57,864507032323403,E91,T333_Y10H1412V046_T,46281520253*86\r\n""",
    b"""F01""": b"""$$j28,353358017784062,F01,OK*19\r\n""",
    b"""F02""": b"""$$Z28,353358017784062,F02,OK*0A\r\n""",
    b"""F08,0,4825000""": b"""$$D28,353358017784062,F08,OK*FA\r\n""",
    b"""F09,1""": b"""$$E28,353358017784062,F09,OK*FC\r\n""",
    b"""F11""": b"""$$[28,353358017784062,F11,OK*0B\r\n""",
}


class NotMyIMEIError(Exception):
    pass


def request_to_response(request_command, imei):
    for key in REQUEST_TO_RESPONSE:
        command_length = len(key)
        if request_command[0:command_length] == key:
            return_gprs = GPRS(REQUEST_TO_RESPONSE[key])
            return_gprs.imei = imei
            print(return_gprs)
            return return_gprs.as_bytes()
    return None


if __name__ == '__main__':
    log_level = 11 - 11

    logger = logging.getLogger('')
    logger.setLevel(logging.DEBUG)
    ch = logging.StreamHandler()
    ch.setLevel(logging.DEBUG)
    formatter = logging.Formatter(
        '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
    )
    ch.setFormatter(formatter)
    logger.addHandler(ch)

    for command in REQUEST_TO_RESPONSE:
        test_gprs = request_to_response(command, b"IMEI")
        print(test_gprs)